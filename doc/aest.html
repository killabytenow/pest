<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title></title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:root@localhost" />
</head>

<body>



<ul id="index">
  <li><a href="#NAME">NAME</a></li>
  <li><a href="#SYNOPSIS">SYNOPSIS</a>
    <ul>
      <li><a href="#Examples">Examples:</a></li>
      <li><a href="#Options">Options:</a></li>
      <li><a href="#Actions">Actions:</a></li>
    </ul>
  </li>
  <li><a href="#DESCRIPTION">DESCRIPTION</a></li>
  <li><a href="#ACTIONS">ACTIONS</a></li>
  <li><a href="#OPTIONS">OPTIONS</a></li>
  <li><a href="#SEE-ALSO">SEE ALSO</a></li>
</ul>

<h1 id="NAME">NAME</h1>

<p>aest - Authorizator for EST service</p>

<h1 id="SYNOPSIS">SYNOPSIS</h1>

<h2 id="Examples">Examples:</h2>

<ul>

<pre><code>  ./aest [options] [actions ...]
  ./aest -d certs add &quot;/CN=auth subject&quot; signer_id &quot;/CN=assigned subject&quot;
  ./aest -d certs list
  ./aest -d certs check aut.pem &quot;/CN=requested subject&quot;
  ./aest -k -d certs check aut.pem &quot;/CN=requested subject&quot;
  ./aest -D -d certs check aut.pem &quot;/CN=requested subject&quot;
  ./aest -d certs reset</code></pre>

</ul>

<h2 id="Options">Options:</h2>

<ul>

<pre><code>  -d, --cert-dir=s    Directory with certificates generated by TEST.
  -D, --debug         Print debug information.
  -h, --help          Brief help message.
  -m, --man           Full documentation.
  -N, --no-delete     Do not delete checked entries by action &#39;check&#39;
  -v, --verbose       Verbose messages.
  -V, --version       Print version information.</code></pre>

</ul>

<h2 id="Actions">Actions:</h2>

<ul>

<pre><code>  add           Add a new entry in the whitelist.
  check         Check if a PEM file requesting certain subject is allowed to
                enroll. This action also removes authorized entries.
  list          List whitelist entries.
  reset         Clean database
  nop           NOP</code></pre>

</ul>

<h1 id="DESCRIPTION">DESCRIPTION</h1>

<p><b>AEST</b> is a simple authorizer for integrating with a EST service. It decides, according a whitelist, if a device can enroll (or not).</p>

<h1 id="ACTIONS">ACTIONS</h1>

<p>Each invocation to <b>AEST</b> must be accompanied by an action:</p>

<ul>

<dl>

<dt id="add"><b>add</b></dt>
<dd>

<p>This action adds a new entry in the whitelist. It requires the following parameters:</p>

<dl>

<dt id="authentication_subject"><code>authentication_subject</code></dt>
<dd>

<p>The subject found in the certificate that will be used for authenticating against the EST server.</p>

</dd>
<dt id="authentication_issuer_id"><code>authentication_issuer_id</code></dt>
<dd>

<p>The ID used for signing the certificate in the <code>test.conf</code> configuration file in the <code>[certificates]</code> section. For instance, <code>ManufB</code> refers to the <i>Manufacturer B</i> Sub-CA.</p>

</dd>
<dt id="assigned_subject_name"><code>assigned_subject_name</code></dt>
<dd>

<p>When a device uses EST for enrolling, it may ask for a new subject name. This parameter is the subject name expected to be requested by the device. Note that it may be different from the <code>authentication_subject</code>.</p>

</dd>
</dl>

<p>Example:</p>

<pre><code>    ./authorizator -d certs \
        add &quot;/CN=modelB SN 00110-0001/OU=Comm devs/O=RCU/C=UK&quot; \
        ManufB \
        &quot;/CN=dec001.testca/O=testca/C=ES&quot;</code></pre>

</dd>
<dt id="check"><b>check</b></dt>
<dd>

<p>Check if a PEM file requesting certain subject is allowed to enroll. This action also removes authorized entries.</p>

<p>The EST server should call this action passing the following arguments:</p>

<dl>

<dt id="authentication_PEM_File"><code>authentication_PEM_File</code></dt>
<dd>

<p>The EST server must extract the client certificate used during TLS authentication, save it to disk and pass its path to this program.</p>

</dd>
<dt id="requested_subject"><code>requested_subject</code></dt>
<dd>

<p>This is the requested subject during the enrollment. The EST must extract it from the CSR passed by the client.</p>

</dd>
</dl>

<p>This command exits with code 0 if everything is OK, with a exit code different of zero if some error happened.</p>

<p>By default, this command removes the entry that matched succesfully with this authentication. If you want to keep the whitelist untouched, then add the <code>-k</code> flag parameter.</p>

<p>Example of invocations:</p>

<pre><code>  $ ./aest -D -d certs check certs/dev002.pem \
                             &quot;/CN=dec001.testca/O=testca/C=ES&quot; \
    &amp;&amp; echo &quot;ENROLLED!&quot;
  ./aest:DBG: Action &#39;check&#39;
  ./aest:MSG: Checking &#39;/CN=modelB SN 00110-0001/OU=Comm devs/O=RCU/C=UK&#39; (certs/dev002.pem) requesting &#39;/CN=dec001.testca/O=testca/C=ES&#39;.
  ./aest:FAT: Cannot enroll
  
  $ ./aest -D -d certs check certs/dev002.pem \
                             &quot;/CN=dec001.testca/O=testca/C=ES&quot; \
    &amp;&amp; echo &quot;ENROLLED!&quot;
  ./aest:DBG: Action &#39;check&#39;
  ./aest:MSG: Checking &#39;/CN=modelB SN 00110-0001/OU=Comm devs/O=RCU/C=UK&#39; ...
            ...(certs/dev002.pem) requesting &#39;/CN=dec001.testca/O=testca/C=ES&#39;.
  ./aest:DBG:   - signer &#39;ManufB&#39;, requested &#39;/CN=dec001.testca/O=testca/C=ES&#39;
  certs/dev002.pem: OK
  ./aest:MSG: Can enroll!
  ./aest:DBG:   - Deleting seleted auth
  ENROLLED!</code></pre>

</dd>
<dt id="list"><b>list</b></dt>
<dd>

<p>List whitelist entries.</p>

</dd>
<dt id="reset"><b>reset</b></dt>
<dd>

<p>Clean database. Delete all entries.</p>

</dd>
<dt id="nop"><b>nop</b></dt>
<dd>

<p>Nothing to see here. Move along.</p>

</dd>
</dl>

</ul>

<h1 id="OPTIONS">OPTIONS</h1>

<p><b>AEST</b> supports the following options:</p>

<ul>

<dl>

<dt id="d---cert-dir-s"><b>-d</b>, <b>--cert-dir</b>=<i>s</i></dt>
<dd>

<p>Directory with certificates generated by TEST.</p>

</dd>
<dt id="D---debug"><b>-D</b>, <b>--debug</b></dt>
<dd>

<p>Dump HTTP communications and other useful debug information. This flag also enables verbosity (see <i>-v</i>).</p>

</dd>
<dt id="h---help"><b>-h</b>, <b>--help</b></dt>
<dd>

<p>Print a brief help message and exits.</p>

</dd>
<dt id="m---man"><b>-m</b>, <b>--man</b></dt>
<dd>

<p>Prints the manual page and exits.</p>

</dd>
<dt id="N---no-delete"><b>-N</b>, <b>--no-delete</b></dt>
<dd>

<p>Do not delete entries from the whitelist that have been succesfully matched by action &#39;check&#39;. It allows to verify if a certain enrollment may work without altering the whitelist database.</p>

</dd>
<dt id="v---verbose"><b>-v</b>, <b>--verbose</b></dt>
<dd>

<p>Verbose messages.</p>

</dd>
<dt id="V---version"><b>-V</b>, <b>--version</b></dt>
<dd>

<p>Print version information.</p>

</dd>
</dl>

</ul>

<h1 id="SEE-ALSO">SEE ALSO</h1>

<dl>

<dt id="pest"><a>pest</a></dt>
<dd>

<p>PEST manual page.</p>

</dd>
<dt id="test"><a>test</a></dt>
<dd>

<p>TEST manual page.</p>

</dd>
<dt id="test.conf"><a>test.conf</a></dt>
<dd>

<p>A complete test suite for testing an EST server supporting enrollments based on third-party CA issued certificates. This means that clients authenticate themselves using a certificate belonging to an external CA during enrollment. Once they are enrolled, re-enrollments are conducted using the EST CA.</p>

</dd>
<dt id="demo.conf-in-demo"><a>&quot;demo.conf&quot; in demo</a></dt>
<dd>

<p>A complete (and simpler) test suite for testing the public EST service found in <a href="http://testrfc7030.com/">http://testrfc7030.com/</a>.</p>

</dd>
<dt id="http:-www.testrfc7030.com"><a href="http://www.testrfc7030.com/">http://www.testrfc7030.com/</a></dt>
<dd>

<p>This server can be used to test the EST protocol as defined in RFC 7030.</p>

</dd>
</dl>


</body>

</html>


